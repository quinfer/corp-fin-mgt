<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Corporate Financial Management</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Corporate Financial Management</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Day 1</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-1">    
        <li>
    <a class="dropdown-item" href="../days/day1.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../days/day1-morning.html">
 <span class="dropdown-text">Morning Session</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../days/day1-afternoon.html">
 <span class="dropdown-text">Afternoon Session</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-2" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Day 2</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-2">    
        <li>
    <a class="dropdown-item" href="../days/day2.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../days/day2-morning.html">
 <span class="dropdown-text">Morning Session</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../days/day2-afternoon.html">
 <span class="dropdown-text">Afternoon Session</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-3" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Day 3</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-3">    
        <li>
    <a class="dropdown-item" href="../days/day3.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../days/day3-morning.html">
 <span class="dropdown-text">Morning Session</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../days/day3-afternoon.html">
 <span class="dropdown-text">Afternoon Session</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-day-4" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Day 4</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-day-4">    
        <li>
    <a class="dropdown-item" href="../days/day4.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../days/day4-morning.html">
 <span class="dropdown-text">Morning Session</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../days/day4-afternoon.html">
 <span class="dropdown-text">Afternoon Session</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../days/presentations.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#acf838-corporate-financial-management" id="toc-acf838-corporate-financial-management" class="nav-link active" data-scroll-target="#acf838-corporate-financial-management">ACF838 Corporate Financial Management</a>
  <ul class="collapse">
  <li><a href="#coursework-50-of-final-mark" id="toc-coursework-50-of-final-mark" class="nav-link" data-scroll-target="#coursework-50-of-final-mark">Coursework (50% of final mark)</a>
  <ul class="collapse">
  <li><a href="#submission-date" id="toc-submission-date" class="nav-link" data-scroll-target="#submission-date">Submission date:</a></li>
  </ul></li>
  <li><a href="#assignment-description" id="toc-assignment-description" class="nav-link" data-scroll-target="#assignment-description">Assignment description:</a>
  <ul class="collapse">
  <li><a href="#case-1" id="toc-case-1" class="nav-link" data-scroll-target="#case-1">Case 1</a></li>
  <li><a href="#case-2" id="toc-case-2" class="nav-link" data-scroll-target="#case-2">Case 2</a></li>
  </ul></li>
  <li><a href="#suggested-report-structure" id="toc-suggested-report-structure" class="nav-link" data-scroll-target="#suggested-report-structure">Suggested Report Structure</a>
  <ul class="collapse">
  <li><a href="#attention-students-a-word-on-word-counts" id="toc-attention-students-a-word-on-word-counts" class="nav-link" data-scroll-target="#attention-students-a-word-on-word-counts">ATTENTION STUDENTS: A WORD ON WORD COUNTS ⚠️</a></li>
  </ul></li>
  <li><a href="#marking-scheme" id="toc-marking-scheme" class="nav-link" data-scroll-target="#marking-scheme">Marking Scheme</a></li>
  <li><a href="#assignment-guidance" id="toc-assignment-guidance" class="nav-link" data-scroll-target="#assignment-guidance">Assignment guidance:</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Corporate Financial Management</h1>
<p class="subtitle lead">Coursework Assignment</p>
</div>



<div class="quarto-title-meta column-page-left">

    
  
    
  </div>
  


</header>


<section id="acf838-corporate-financial-management" class="level1">
<h1>ACF838 Corporate Financial Management</h1>
<section id="coursework-50-of-final-mark" class="level2">
<h2 class="anchored" data-anchor-id="coursework-50-of-final-mark">Coursework (50% of final mark)</h2>
<section id="submission-date" class="level3">
<h3 class="anchored" data-anchor-id="submission-date">Submission date:</h3>
<p>This assignment must be submitted electronically through Blackboard Ultra by <strong>12:00 Noon on Friday 7th June 2025</strong>.</p>
<p>Feedback will be available within two weeks of submission.</p>
<hr>
</section>
</section>
<section id="assignment-description" class="level2">
<h2 class="anchored" data-anchor-id="assignment-description">Assignment description:</h2>
<section id="case-1" class="level3">
<h3 class="anchored" data-anchor-id="case-1">Case 1</h3>
<p>The directors of Ribs Co, a listed company in the UK, are reviewing the company’s current strategic position. The firm makes high quality garden tools which it sells in its domestic market but not abroad.</p>
<p>Over the last few years, the share price has risen significantly as the firm has expanded organically within its domestic market. Unfortunately, in the last 12 months, the influx of cheaper, foreign tools has adversely impacted the firm’s profitability. Consequently, the share price has dropped sharply in recent weeks and the shareholders expressed their displeasure at the recent AGM.</p>
<p>The directors are evaluating 2 alternative investment projects which they hope will arrest the decline in profitability:</p>
<p><strong>Project 1</strong>: This would involve closing the firm’s domestic factory and switching production to a foreign country where labour rates are 1/4 of those in that domestic market. Sales will continue to be targeted exclusively as the domestic market.</p>
<p><strong>Project 2</strong>: This would involve a new investment in machinery at the domestic factory to allow production to be increased by 50%. The extra tools would be exported and sold as high quality tools in foreign market places.</p>
<p>Both projects have a positive Net Present Value when discounted at the firm’s current cost of capital.</p>
<p><strong>Required:</strong> Discuss the strategic and financial issues that this case presents.</p>
<p>(30 marks)</p>
<hr>
</section>
<section id="case-2" class="level3">
<h3 class="anchored" data-anchor-id="case-2">Case 2</h3>
<p>For Project 2 mentioned above, the firm’s financial manager made the following estimates.</p>
<p>The new machinery costs £4.5 million, which the supplier requires payment upfront. It would bring annual increase in revenues over the next five years of £2 million.</p>
<p>This project will lead to an increase in wage costs of £0.4 million per year and will also require expenditure of £0.3 million per year to maintain the level of existing machinery to be used on the project.</p>
<p>The following forecasts are made of the rates of inflation each year for the next five years:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Item</th>
<th>Annual Inflation Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Revenues</td>
<td>No inflation in revenues</td>
</tr>
<tr class="even">
<td>Wages</td>
<td>5%</td>
</tr>
<tr class="odd">
<td>Asset maintaining expenses</td>
<td>6%</td>
</tr>
</tbody>
</table>
<p>The real cost of capital of the firm is 8%. General inflation is 3.5%.</p>
<p>All cash flows are in real terms. Ignore tax.</p>
<p><strong>Required:</strong></p>
<ol type="1">
<li>Determine the NPV of this project. (20 marks)</li>
<li>As Project 2 involves selling in foreign markets, analyse the project’s sensitivity to annual revenue. What is the minimum revenue figure for the project to breakeven? (10 marks)</li>
<li>On 25 July 2024, the Directive on Corporate Sustainability Due Diligence (Directive 2024/1760) entered into force. Briefly discuss how this Directive impacts Ribs Co’s operation if the firm decides to sell their tools in EU countries. (40 marks)</li>
</ol>
<hr>
</section>
</section>
<section id="suggested-report-structure" class="level2">
<h2 class="anchored" data-anchor-id="suggested-report-structure">Suggested Report Structure</h2>
<p>Your submitted report should be professionally presented and structured as follows:</p>
<ol type="1">
<li><p><strong>Title Page</strong>: Include module code, assignment title, student number, and submission date.</p></li>
<li><p><strong>Executive Summary</strong>: Brief overview of the report’s key findings and conclusions (approx. 200 words).</p></li>
<li><p><strong>Table of Contents</strong>: Include page numbers for all sections.</p></li>
<li><p><strong>Introduction</strong>: Brief context setting for the assignment.</p></li>
<li><p><strong>Case 1 Analysis</strong>:</p>
<ul>
<li>Strategic considerations (domestic vs.&nbsp;international production)</li>
<li>Financial implications of both projects</li>
<li>Stakeholder impact analysis</li>
<li>Risk assessment</li>
<li>Recommendations</li>
</ul></li>
<li><p><strong>Case 2 Analysis</strong>:</p>
<ul>
<li>NPV calculation with clear workings</li>
<li>Sensitivity analysis</li>
<li>Corporate sustainability analysis</li>
<li>Critical evaluation of findings</li>
</ul></li>
<li><p><strong>Conclusion</strong>: Summary of key findings and final recommendations.</p></li>
<li><p><strong>References</strong>: Harvard referencing style.</p></li>
<li><p><strong>Appendices</strong>: Any supplementary calculations or material.</p></li>
</ol>
<p>The word limit for this assignment is 3,000 words (±10%), excluding the title page, references, and appendices.</p>
<section id="attention-students-a-word-on-word-counts" class="level3">
<h3 class="anchored" data-anchor-id="attention-students-a-word-on-word-counts">ATTENTION STUDENTS: A WORD ON WORD COUNTS ⚠️</h3>
<p>Regarding this assignment, I’d like to clarify that the 3,000-word limit (excluding references, appendices, and tables) is precisely that—a limit, not a target.</p>
<p>Think of it as academic headroom, not a volume to fill. I’m far more interested in your concise, well-reasoned arguments than watching you stretch your prose to reach an arbitrary number. Quality thinking expressed clearly will always impress more than verbose padding.</p>
<p>Some of the finest academic work I’ve assessed over my career has come in well under the maximum word count. Remember that editing is as much a skill as writing.</p>
<p>A particular warning: submissions filled with shallow, verbose text that meanders without depth or precision are rather conspicuous—and often betray the uncritical use of AI assistance without proper intellectual engagement. Such papers stand out like a sore thumb to experienced markers.</p>
<p>As your professor, I’ll be looking for your authentic scholarly voice and critical thinking, not an algorithm’s ability to generate word count. Substance over length, always.</p>
<p>Write until you’ve made your point brilliantly—then stop.</p>
<hr>
</section>
</section>
<section id="marking-scheme" class="level2">
<h2 class="anchored" data-anchor-id="marking-scheme">Marking Scheme</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 39%">
<col style="width: 35%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Component</th>
<th>Criteria</th>
<th>Marks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Case 1 Analysis</strong> (30%)</td>
<td>• Comprehensive strategic analysis<br>• Thorough financial considerations<br>• Well-developed stakeholder analysis<br>• Nuanced risk assessment<br>• Clear recommendations backed by evidence</td>
<td>30</td>
</tr>
<tr class="even">
<td><strong>Case 2 - NPV Calculation</strong> (20%)</td>
<td>• Accuracy of calculations<br>• Appropriate adjustment for inflation<br>• Correct application of discounting<br>• Clear presentation of workings<br>• Logical explanation of approach</td>
<td>20</td>
</tr>
<tr class="odd">
<td><strong>Case 2 - Sensitivity Analysis</strong> (10%)</td>
<td>• Correct application of technique<br>• Accurate determination of threshold value<br>• Critical interpretation of results<br>• Clear presentation of findings</td>
<td>10</td>
</tr>
<tr class="even">
<td><strong>Case 2 - Sustainability Analysis</strong> (40%)</td>
<td>• Comprehensive understanding of the Directive<br>• Thorough application to the case<br>• Critical evaluation of implications<br>• Thoughtful discussion of recommendations<br>• Integration with financial considerations</td>
<td>40</td>
</tr>
</tbody>
</table>
<p><strong>Grade descriptors:</strong></p>
<ul>
<li><strong>70%+</strong>: Exceptional work demonstrating comprehensive understanding, critical analysis, and insightful application of theory to practice.</li>
<li><strong>60-69%</strong>: Very good work showing thorough understanding and solid analysis with good application of theory.</li>
<li><strong>50-59%</strong>: Satisfactory work with adequate understanding and basic application of concepts.</li>
<li><strong>40-49%</strong>: Basic work showing limited understanding with minimal analysis.</li>
<li><strong>&lt;40%</strong>: Unsatisfactory work with significant gaps in understanding and analysis.</li>
</ul>
<hr>
</section>
<section id="assignment-guidance" class="level2">
<h2 class="anchored" data-anchor-id="assignment-guidance">Assignment guidance:</h2>
<ul>
<li>Please submit your report through the Turnitin link on Blackboard Ultra. A similarity report will be generated on submission.</li>
<li>Marks are awarded for content, quality of discussion and effective use of referencing. To achieve high marks, students will be expected to demonstrate a familiarity with the wider literature in the subject area, and not merely an ability to reproduce the lecture notes. Higher marks will also be awarded to students who provide strong evidence of analysis and critical evaluation of the various concepts and techniques identified and their application to real-world situations. A demonstration of understanding of real-world finance development is also recommended.</li>
<li>Work should include references to journal articles and other relevant publications, and should be properly laid out using the Harvard referencing system.</li>
<li>More detailed guidance is available in the ‘Guide to Referencing in the Harvard Style’. We encourage you to avail of the Academic Support via the Library’s Support Service, further details in the Library’s website.</li>
<li>Marks will be deducted for incomplete or inaccurate referencing.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/quinfer\.github\.io\/corp-fin-mgt\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>