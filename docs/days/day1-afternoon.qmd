---
title: "Corporate Financial Management"
subtitle: "Day 1 Afternoon: Capital Investment Decisions"
author: "Barry Quinn"
date: last-modified
format:
  html:
    toc: true
    theme: cosmo
    css: "../styles.css"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(knitr)
library(ggplot2)
```

## Capital Investment Decision-Making {.unnumbered}

This afternoon, we build upon the financial framework and ratio analysis covered this morning to focus on one of the most critical aspects of financial management: capital investment decisions.

:::{.callout-note}
## Learning Outcomes for This Session
By the end of this afternoon, you will be able to:

1. Explain the nature and importance of investment decision-making
2. Identify and evaluate the five main investment appraisal methods found in practice
3. Use these methods to reach decisions on investment opportunities
4. Explain the key stages in the investment decision-making process
5. Apply techniques to handle risk in investment decisions
:::

## The Nature of Investment Decisions

Investment decisions represent long-term commitments of substantial resources with uncertain returns. They are among the most consequential decisions finance managers must make.

:::{.panel-tabset}
### Key Characteristics

Capital investment decisions typically involve:

- Large amounts of resources
- Relatively long timescales
- Difficulty or expense in reversing the investment once undertaken
- Strategic implications for the organisation's future direction
- Complex risk considerations

### Investment Decision Framework

```{mermaid}
flowchart TD
    A[Identify investment opportunity] --> B[Gather relevant information]
    B --> C[Evaluate using appraisal techniques]
    C --> D[Consider risk factors]
    D --> E[Make investment decision]
    E --> F[Implement and monitor]
    F --> G[Post-implementation review]
```

### Real-World Example

The pharmaceutical industry provides a classic example of the capital investment decision challenge:

- Initial R&D investment: £500m+
- Development timeline: 10-15 years
- Success rate: Only 1 in 10 compounds receives regulatory approval
- Strategic importance: Defines company product pipeline for decades
- High uncertainty: Market conditions may change substantially before launch
:::

## Cash Flows vs. Accounting Profits

A fundamental principle in capital investment appraisal is the focus on cash flows rather than accounting profits.

:::{.grid}
::: {.g-col-6}
**Key Equation:**
$$\text{Cash Flow} = \text{Profit} + \text{Depreciation} + \text{Other non-cash adjustments}$$

**Why Focus on Cash Flows?**
- Cash is objective and measurable
- Profits are subject to accounting policies
- Cash flow timing directly impacts value
- Investment decisions affect cash balances
:::

::: {.g-col-6}
**Relevant Cash Flows Are:**
- Incremental (arising directly from the project)
- Future (not past/sunk costs)
- After-tax

**Irrelevant Items Include:**
- Sunk costs
- Non-incremental overhead allocations
- Interest payments (captured in discount rate)
- Accounting conventions
:::
:::

:::{.callout-important}
## Common Error
Including already committed (sunk) costs in investment appraisal calculations. Once spent, these costs are irrelevant to the decision to proceed.
:::

## Projected Income Statement vs. Cash Flow

Consider how an accounting statement differs from the cash flow perspective:

```{r}
income_statement <- data.frame(
  Item = c("Credit sales revenue", 
           "Less Cost of sales:",
           "  Opening inventories",
           "  Add Purchases",
           "  Less Closing inventories",
           "Gross profit",
           "Less:",
           "  Credit card discounts",
           "  Rent and rates",
           "  Other costs",
           "  Depreciation of fittings",
           "Profit for the period"),
  Amount1 = c("1,200", "", "100", "750", "(120)", "", "", "60", "180", "240", "140", ""),
  Amount2 = c("", "", "", "", "730", "470", "", "", "", "", "620", "(150)")
)

kable(income_statement, col.names = c("", "£000", "£000"), align = "lrr", caption = "Typical Income Statement")
```

:::{.callout-note}
## Key Cash Flow Conversion
Income statement to cash flow adjustments:
- Add back non-cash expenses (e.g., depreciation: +£140,000)
- Adjust for working capital changes (e.g., inventory increase: -£20,000)
- Exclude financing costs (captured in the discount rate)
:::

## Investment Appraisal Methods Overview

Five main methods are used in practice to evaluate investment projects:

:::{.panel-tabset}
### Classification Framework

```{mermaid}
flowchart TD
    A[Investment Appraisal Methods] --> B[Discounted Cash Flow Methods]
    A --> C[Non-Discounted Cash Flow Methods]
    A --> D[Accounting Profit-Based]
    B --> E[Net Present Value]
    B --> F[Internal Rate of Return]
    B --> G[Discounted Payback]
    C --> H[Payback Period]
    D --> I[Accounting Rate of Return]
```

### Discounted Cash Flow Methods

**Time Value of Money Principle:**
Future cash flows are worth less than immediate cash flows due to:
- Opportunity cost of capital
- Inflation
- Risk

DCF methods explicitly account for this through discounting.

### Selection in Practice

```{r, fig.width=10, fig.height=6}
years <- 2000:2020
NPV_usage <- 60 + (0:20)*0.8
IRR_usage <- 55 + (0:20)*1.0
PP_usage <- 80 - (0:20)*0.5
ARR_usage <- 75 - (0:20)*0.8

df <- data.frame(Year = rep(years, 4),
                Method = factor(rep(c("Net Present Value", "Internal Rate of Return", 
                                      "Payback Period", "Accounting Rate of Return"), each = 21)),
                Usage = c(NPV_usage, IRR_usage, PP_usage, ARR_usage))

ggplot(df, aes(x = Year, y = Usage, color = Method, group = Method)) +
  geom_line(size = 1.2) +
  geom_point(size = 2.5) +
  theme_minimal() +
  labs(title = "Trends in Investment Appraisal Method Usage",
       y = "Percentage of Companies Using Method",
       x = "Year") +
  scale_y_continuous(limits = c(45, 90)) +
  theme(legend.position = "right",
        plot.title = element_text(hjust = 0.5, face = "bold"))
```
:::

## Payback Period (PP)

The Payback Period is the time required to recover the initial investment from project cash flows.

:::{.panel-tabset}
### Definition & Calculation

$$\text{Payback Period} = \text{Time until} \sum_{t=0}^{n} \text{Cash Flow}_t = 0$$

Where:
- t = time period (typically years)
- n = payback period

**Decision Rule:**
- Accept projects with PP < maximum acceptable period
- Between competing projects, prefer shorter payback

### Example

A project costs £500,000 with the following expected cash flows:

```{r}
payback_example <- data.frame(
  Year = 0:5,
  Cash_Flow = c(-500000, 150000, 180000, 200000, 120000, 100000),
  Cumulative = c(-500000, -350000, -170000, 30000, 150000, 250000)
)

kable(payback_example, col.names = c("Year", "Cash Flow (£)", "Cumulative Cash Flow (£)"), 
      align = "rrr")
```

Payback period = 2 + (170,000 ÷ 200,000) = 2.85 years

### Advantages & Limitations

**Advantages:**
- Simple to calculate and understand
- Focuses on liquidity and capital recovery
- Provides a crude measure of risk
- Popular in practice

**Limitations:**
- Ignores cash flows after the payback period
- Fails to consider time value of money
- Ignores the scale of investment
- Payback threshold typically arbitrary
- Not linked to shareholder wealth maximization
:::

## Discounted Payback Period (DPP)

The Discounted Payback Period addresses a key limitation of the standard payback by considering the time value of money.

:::{.panel-tabset}
### Definition & Calculation

$$\text{Discounted Payback Period} = \text{Time until} \sum_{t=0}^{n} \frac{\text{Cash Flow}_t}{(1+r)^t} = 0$$

Where:
- t = time period (typically years)
- r = discount rate
- n = discounted payback period

**Decision Rule:**
- Accept projects with DPP < maximum acceptable period
- Between competing projects, prefer shorter discounted payback

### Example

Using the same project with a 10% discount rate:

```{r}
discount_rate <- 0.10
dpp_example <- data.frame(
  Year = 0:5,
  Cash_Flow = c(-500000, 150000, 180000, 200000, 120000, 100000),
  Discount_Factor = c(1, 1/(1+discount_rate)^1, 1/(1+discount_rate)^2, 1/(1+discount_rate)^3, 
                     1/(1+discount_rate)^4, 1/(1+discount_rate)^5),
  Discounted_CF = c(-500000, 150000/(1+discount_rate)^1, 180000/(1+discount_rate)^2, 
                    200000/(1+discount_rate)^3, 120000/(1+discount_rate)^4, 100000/(1+discount_rate)^5),
  Cumulative_DCF = cumsum(c(-500000, 150000/(1+discount_rate)^1, 180000/(1+discount_rate)^2, 
                           200000/(1+discount_rate)^3, 120000/(1+discount_rate)^4, 100000/(1+discount_rate)^5))
)

# Format for display
dpp_example$Discount_Factor <- round(dpp_example$Discount_Factor, 3)
dpp_example$Discounted_CF <- round(dpp_example$Discounted_CF, 0)
dpp_example$Cumulative_DCF <- round(dpp_example$Cumulative_DCF, 0)

kable(dpp_example, col.names = c("Year", "Cash Flow (£)", "Discount Factor", 
                                "Discounted CF (£)", "Cumulative DCF (£)"), 
      align = "rrrrr")
```

Discounted payback period = 3 + (-16,400 ÷ 81,640) = 3.20 years

### Advantages & Limitations

**Advantages:**
- Accounts for time value of money (unlike PP)
- Maintains simplicity of interpretation
- More realistic measure of capital recovery time

**Limitations:**
- Still ignores cash flows after the payback period
- Arbitrary threshold for acceptable period
- Not directly linked to shareholder wealth maximization
:::

## Net Present Value (NPV)

The Net Present Value method is the most theoretically sound approach to investment appraisal, directly linking to shareholder wealth maximization.

:::{.panel-tabset}
### Definition & Calculation

$$\text{NPV} = \sum_{t=0}^{n} \frac{\text{Cash Flow}_t}{(1+r)^t}$$

Where:
- t = time period (typically years)
- r = discount rate (cost of capital)
- n = project lifetime

**Decision Rule:**
- Accept projects with NPV > 0
- Reject projects with NPV < 0
- Between competing projects, prefer higher NPV

### Discount Rate Components

```{mermaid}
flowchart LR
    A[Risk-free rate] --> D[Required return]
    B[Inflation premium] --> D
    C[Risk premium] --> D
    D --> E[Discount rate for NPV]
```

The discount rate used in NPV calculations reflects:
- Time value of money (risk-free rate)
- Inflation expectations
- Project-specific risk factors

### Example

Using the same project with a 10% discount rate:

```{r}
npv_example <- dpp_example[, c("Year", "Cash_Flow", "Discount_Factor", "Discounted_CF")]
npv_sum <- sum(npv_example$Discounted_CF)

kable(npv_example, col.names = c("Year", "Cash Flow (£)", "Discount Factor", 
                                "Discounted CF (£)"), 
      align = "rrrr")
```

NPV = £`r format(npv_sum, big.mark=",")`

### Advantages & Limitations

**Advantages:**
- Considers all cash flows over project life
- Accounts for time value of money
- Directly linked to shareholder wealth maximization
- Allows for risk adjustment via discount rate
- Additive across projects

**Limitations:**
- More complex to calculate and explain
- Highly sensitive to discount rate selection
- Assumes reinvestment at the discount rate
- Provides absolute rather than relative measure
:::

## Internal Rate of Return (IRR)

The Internal Rate of Return is the discount rate at which a project's NPV equals zero, representing the project's "yield."

:::{.panel-tabset}
### Definition & Calculation

IRR is the value of r that satisfies:

$$\sum_{t=0}^{n} \frac{\text{Cash Flow}_t}{(1+r)^t} = 0$$

Typically solved through iteration or financial calculators.

**Decision Rule:**
- Accept projects with IRR > cost of capital
- Reject projects with IRR < cost of capital
- Between competing projects, prefer higher IRR

### Example

Using the same project cash flows:

```{r}
irr_example <- data.frame(
  Year = 0:5,
  Cash_Flow = c(-500000, 150000, 180000, 200000, 120000, 100000)
)

# Calculate IRR
cf <- irr_example$Cash_Flow
irr <- function(cf, guess = 0.1) {
  f <- function(r) sum(cf / (1 + r)^(0:(length(cf)-1)))
  uniroot(f, c(0, 1))$root
}

calculated_irr <- irr(cf)

kable(irr_example, col.names = c("Year", "Cash Flow (£)"), align = "rr")
```

IRR = `r round(calculated_irr*100, 2)`%

Since IRR (`r round(calculated_irr*100, 2)`%) > Cost of capital (10%), the project is acceptable.

### NPV-IRR Relationship

```{r, fig.width=10, fig.height=6}
discount_rates <- seq(0, 0.30, by = 0.01)
npvs <- sapply(discount_rates, function(r) sum(cf / (1 + r)^(0:(length(cf)-1))))

df_npv_profile <- data.frame(Rate = discount_rates*100, NPV = npvs)

ggplot(df_npv_profile, aes(x = Rate, y = NPV)) +
  geom_line(size = 1.2, color = "blue") +
  geom_point(data = df_npv_profile[which.min(abs(df_npv_profile$NPV)), ], 
             aes(x = Rate, y = NPV), size = 4, color = "red") +
  geom_hline(yintercept = 0, linetype = "dashed") +
  geom_vline(xintercept = calculated_irr*100, linetype = "dashed", color = "red") +
  annotate("text", x = calculated_irr*100 + 2, y = 50000, 
           label = paste("IRR =", round(calculated_irr*100, 2), "%"), color = "red") +
  theme_minimal() +
  labs(title = "NPV Profile and IRR",
       x = "Discount Rate (%)",
       y = "Net Present Value (£)") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))
```

### Advantages & Limitations

**Advantages:**
- Intuitive percentage return format
- Accounts for time value of money
- Considers all cash flows
- Popular with practitioners

**Limitations:**
- Multiple IRRs possible with non-conventional cash flows
- Scale of investment not considered
- Reinvestment assumption may be unrealistic
- Ranking conflicts with NPV possible
- Not directly linked to shareholder wealth maximization
:::

## Accounting Rate of Return (ARR)

The Accounting Rate of Return focuses on accounting profit rather than cash flows.

:::{.panel-tabset}
### Definition & Calculation

$$\text{ARR} = \frac{\text{Average annual profit}}{\text{Average investment}} \times 100\%$$

Where:
- Average annual profit = Total project profits ÷ Project life
- Average investment = (Initial investment + Residual value) ÷ 2

**Decision Rule:**
- Accept projects with ARR > minimum required return
- Reject projects with ARR < minimum required return
- Between competing projects, prefer higher ARR

### Example

A project requires an initial investment of £500,000 with the following profit projections:

```{r}
arr_example <- data.frame(
  Year = 1:5,
  Profit = c(90000, 110000, 130000, 80000, 70000)
)

# Calculate ARR
initial_investment <- 500000
residual_value <- 100000
average_investment <- (initial_investment + residual_value) / 2
total_profit <- sum(arr_example$Profit)
average_profit <- total_profit / 5
arr <- (average_profit / average_investment) * 100

kable(arr_example, col.names = c("Year", "Accounting Profit (£)"), align = "rr")
```

Average annual profit = £`r format(average_profit, big.mark=",")` <br>
Average investment = £`r format(average_investment, big.mark=",")` <br>
ARR = `r round(arr, 1)`%

### Advantages & Limitations

**Advantages:**
- Uses familiar accounting concepts
- Simple to calculate
- Addresses profitability directly
- No discounting required

**Limitations:**
- Based on accounting profits, not cash flows
- Ignores time value of money
- No objective benchmark for minimum ARR
- Sensitive to accounting policies
- Multiple calculation methods exist
:::

## Comparison of Appraisal Methods

The following table summarizes key features of the five investment appraisal methods:

```{r}
comparison <- data.frame(
  Method = c("Payback Period (PP)", "Discounted Payback Period (DPP)", 
             "Net Present Value (NPV)", "Internal Rate of Return (IRR)", 
             "Accounting Rate of Return (ARR)"),
  Considers_Time_Value = c("No", "Yes", "Yes", "Yes", "No"),
  Considers_All_Cash_Flows = c("No", "No", "Yes", "Yes", "Yes"),
  Linked_to_Shareholder_Value = c("No", "No", "Yes", "Indirectly", "No"),
  Complexity = c("Low", "Medium", "Medium-High", "High", "Low"),
  Format = c("Years", "Years", "Currency", "Percentage", "Percentage")
)

kable(comparison, col.names = c("Method", "Considers Time Value", "Considers All Cash Flows", 
                               "Linked to Shareholder Value", "Complexity", "Format"),
      align = "llllll")
```

:::{.callout-tip}
## Best Practice
Organizations typically use multiple appraisal methods in combination to gain a more complete perspective on potential investments.
:::

## Case Study: Evaluating a New Business Venture

Let's apply these methods to a real-world case:

**Evaluating the Potential of Starting a Plumbing Business**

:::{.panel-tabset}
### Business Plan Overview

The proposal involves:

- **Year 0**: Initial investment (Equipment: £25,000, Van: £15,000, Advertising: £5,000)
- **Years 1-5**: Operations (Building customer base, hiring employees)
- **End of Year 5**: Exit strategy (Sell business for £30,000, equipment value £8,000, van value £3,000)

Expected cash flows:
- Year 1: £12,000
- Year 2: £18,000
- Year 3: £22,000
- Year 4: £25,000
- Year 5: £26,000 (plus exit values)

### Applying PP and DPP

```{r}
# Set up the cash flows
initial_investment <- -(25000 + 15000 + 5000)
annual_cfs <- c(12000, 18000, 22000, 25000, 26000)
final_year_adjustment <- 30000 + 8000 + 3000
cfs <- c(initial_investment, annual_cfs)
cfs[6] <- cfs[6] + final_year_adjustment

# Create the payback table
payback <- data.frame(
  Year = 0:5,
  Cash_Flow = cfs,
  Cumulative = cumsum(cfs)
)

# For discounted payback
discount_rate <- 0.10
dcfs <- cfs / (1 + discount_rate)^(0:5)
cum_dcfs <- cumsum(dcfs)

# Add to table
payback$Discount_Factor <- c(1, 1/(1+discount_rate)^(1:5))
payback$Discounted_CF <- dcfs
payback$Cumulative_DCF <- cum_dcfs

# Format table for display
kable(payback, col.names = c("Year", "Cash Flow (£)", "Cumulative CF (£)", 
                             "Discount Factor", "Discounted CF (£)", "Cumulative DCF (£)"),
      align = "rrrrrr", digits = c(0,0,0,3,0,0))
```

**Payback Period:** Between Year 2 and 3, approximately 2.18 years. <br>
**Discounted Payback Period:** Between Year 3 and 4, approximately 3.74 years.

### Calculating NPV and IRR

```{r}
# NPV calculation
npv_result <- sum(dcfs)

# IRR calculation
irr_result <- irr(cfs)

# Format table for display
npv_irr <- data.frame(
  Metric = c("Net Present Value (NPV)", "Internal Rate of Return (IRR)"),
  Value = c(paste("£", format(round(npv_result, 0), big.mark=",")), 
            paste(round(irr_result*100, 2), "%"))
)

kable(npv_irr, align = "lr")
```

### Calculating ARR

```{r}
# Assuming straight-line depreciation for equipment and van
initial_investment <- 45000
residual_value <- 41000  # Business sale value plus remaining asset values

# Assume we derive accounting profits from the cash flows by deducting depreciation
depreciation <- (initial_investment - residual_value) / 5

accounting_profits <- annual_cfs - depreciation

arr_table <- data.frame(
  Year = 1:5,
  Cash_Flow = annual_cfs,
  Depreciation = rep(depreciation, 5),
  Accounting_Profit = accounting_profits
)

kable(arr_table, col.names = c("Year", "Cash Flow (£)", "Depreciation (£)", "Accounting Profit (£)"),
      align = "rrrr", digits = 0)

average_profit <- mean(accounting_profits)
average_investment <- (initial_investment + residual_value) / 2
arr_result <- (average_profit / average_investment) * 100

arr_calc <- data.frame(
  Metric = c("Average Annual Profit", "Average Investment", "ARR"),
  Value = c(paste("£", format(round(average_profit, 0), big.mark=",")),
            paste("£", format(round(average_investment, 0), big.mark=",")),
            paste(round(arr_result, 1), "%"))
)

kable(arr_calc, align = "lr")
```

### Decision Recommendation

Based on all five appraisal methods, we can make the following assessment:

1. **Payback Period (2.18 years)**: If the maximum acceptable payback is 3 years, the project is acceptable.

2. **Discounted Payback (3.74 years)**: If the maximum acceptable discounted payback is 4 years, the project is acceptable.

3. **NPV (£22,977)**: The positive NPV indicates the project adds value to the business and should be accepted.

4. **IRR (23.92%)**: If the cost of capital is 10%, the project's IRR substantially exceeds this threshold and should be accepted.

5. **ARR (16.4%)**: If the minimum required ARR is 15%, the project is acceptable.

**Recommendation**: The investment in the plumbing business appears financially viable across all appraisal methods. The positive NPV and high IRR are particularly encouraging indicators of value creation.
:::

## Risk in Investment Decisions

Investment decisions inherently involve risk and uncertainty. Several methods exist to incorporate risk assessment into the appraisal process.

:::{.panel-tabset}
### Risk Assessment Approaches

```{mermaid}
flowchart TD
    A[Risk Assessment Methods] --> B[Sensitivity Analysis]
    A --> C[Scenario Analysis]
    A --> D[Risk-Adjusted Discount Rate]
    A --> E[Probability-Based Methods]
    E --> F[Expected NPV]
    E --> G[Monte Carlo Simulation]
    A --> H[Real Options Analysis]
```

### Sensitivity Analysis

Sensitivity analysis examines how changes in key variables affect project outcomes.

**Process:**
1. Identify key variables (e.g., sales volume, price, costs)
2. Calculate impact of percentage changes in each variable
3. Identify switching points where NPV becomes zero
4. Focus management attention on most sensitive variables

**Example**: For our plumbing business, how much would each variable need to change to make NPV zero?

```{r}
# Sensitivity factors
sensitivity <- data.frame(
  Variable = c("Initial investment", "Annual cash flows", "Exit value", "Discount rate"),
  Base_Value = c("£45,000", "As projected", "£41,000", "10%"),
  Change_for_Zero_NPV = c("+51.1%", "-24.0%", "-56.0%", "+13.9 percentage points"),
  Interpretation = c("Low sensitivity", "Moderate sensitivity", "Low sensitivity", "Low sensitivity")
)

kable(sensitivity, col.names = c("Variable", "Base Value", "Change for Zero NPV", "Interpretation"),
      align = "llll")
```

### Scenario Analysis

Scenario analysis evaluates the project under different sets of assumptions.

```{r}
# Scenario analysis
scenarios <- data.frame(
  Scenario = c("Pessimistic", "Most likely", "Optimistic"),
  Annual_Growth = c("5%", "10%", "15%"),
  Exit_Multiple = c("1.0x", "1.5x", "2.0x"),
  NPV = c("£3,250", "£22,977", "£48,350"),
  IRR = c("12.1%", "23.9%", "36.2%")
)

kable(scenarios, col.names = c("Scenario", "Annual Growth", "Exit Multiple", "NPV", "IRR"),
      align = "lllll")
```

### Expected NPV

Expected NPV incorporates probability estimates for different outcomes.

```{r}
# Expected NPV
expected_npv <- data.frame(
  Scenario = c("Pessimistic", "Most likely", "Optimistic", "Expected value"),
  Probability = c("0.25", "0.50", "0.25", "1.00"),
  NPV = c("£3,250", "£22,977", "£48,350", ""),
  Weighted_NPV = c("£813", "£11,489", "£12,088", "£24,390")
)

kable(expected_npv, col.names = c("Scenario", "Probability", "NPV", "Weighted NPV"),
      align = "llll")
```

### Risk Attitudes

Different investors have different risk preferences:

- **Risk-averse** investors: Require compensation for bearing risk
- **Risk-neutral** investors: Focus solely on expected values
- **Risk-seeking** investors: Willing to accept lower expected returns for chance of higher gains

Most corporate decision-makers are risk-averse, which is reflected in:
- Use of hurdle rates above the cost of capital
- Preference for shorter payback periods
- Conservative cash flow projections
:::

## Investment Decision Process in Practice

The investment appraisal techniques are part of a broader investment decision-making process:

```{mermaid}
flowchart TD
    A[1. Determine available funds] --> B[2. Identify investment opportunities]
    B --> C[3. Initial screening]
    C --> D[4. Detailed appraisal]
    D --> E[5. Accept/reject decision]
    E --> F[6. Implementation]
    F --> G[7. Post-implementation review]
```

:::{.callout-note}
## Non-Financial Factors
Financial appraisal provides essential input but should be complemented with consideration of:

- Strategic fit with organizational objectives
- Market position and competitive impacts
- Technical feasibility and resource availability
- Environmental, social, and governance factors
- Regulatory compliance requirements
- Organizational capability and change management
:::

## Post-Completion Audit

After implementing capital investments, organizations should conduct post-completion audits to:

- Compare actual outcomes with projected performance
- Identify reasons for discrepancies
- Improve future forecasting and decision-making
- Create accountability for projections
- Capture learning for future investments

:::{.callout-tip}
## Best Practice
Research shows that companies conducting systematic post-completion audits achieve:
- More accurate future projections
- Better investment performance
- Improved organizational learning
- Enhanced strategic alignment of investments
:::

## Key Takeaways {.unnumbered}

:::{.callout-note appearance="minimal"}
- Investment decisions are among the most consequential in financial management
- Cash flows, not accounting profits, are the basis for sound investment appraisal
- NPV is the most theoretically sound method, directly linked to shareholder value
- Multiple appraisal methods should be used in combination for a complete perspective
- Risk assessment is an essential component of investment decision-making
- The broader organizational and strategic context must be considered alongside financial analysis
- Post-completion audits improve future decision-making
:::

## For Tomorrow {.unnumbered}

Tomorrow morning, we will explore:
- Sources of finance
- Capital structure decisions
- Cost of capital calculation
- Working capital management

Please review the applied exercises at the end of chapter 5 in preparation for our practical session.

## Additional Resources {.unnumbered}

**Core Reading:**
- Brealey, R., Myers, S., & Allen, F. (2023). *Principles of Corporate Finance* (14th ed.), Chapters 5-7
- Arnold, G. (2020). *Corporate Financial Management* (6th ed.), Chapters 2-4

**Online Resources:**
- [Financial Times Market Data](https://markets.ft.com/)
- [Corporate Finance Institute - NPV Calculator](https://corporatefinanceinstitute.com/resources/knowledge/valuation/npv-calculator/)
- [McKinsey & Company on Capital Investment](https://www.mckinsey.com/business-functions/strategy-and-corporate-finance/how-we-help-clients/capital-investment)

## Practice Exercises {.unnumbered}

To consolidate your understanding, attempt these practice problems before tomorrow's session:

1. A project requires an initial investment of £200,000 and is expected to generate annual cash flows of £50,000 for 5 years. Calculate the project's payback period, NPV (using a 12% discount rate), and IRR.

2. Company A is considering two mutually exclusive projects with the following cash flows:

```{r}
exercise <- data.frame(
  Year = 0:4,
  Project_X = c(-300000, 100000, 150000, 150000, 50000),
  Project_Y = c(-300000, 250000, 100000, 50000, 25000)
)

kable(exercise, col.names = c("Year", "Project X (£)", "Project Y (£)"),
      align = "rrr")
```

Using a discount rate of 10%, calculate:
   - The NPV of each project
   - The IRR of each project
   - The payback period of each project
   - Which project should be selected and why?

3. How would your recommendation for question 2 change if:
   - The company's cost of capital increased to 15%?
   - The company faced capital rationing and could only invest £200,000?
   - Project Y's Year 1 cash flow was uncertain and could vary by ±20%?
## Real Options in Capital Investment Decisions

Real options analysis recognises that investment decisions often contain embedded options that can significantly impact project value.

:::{.panel-tabset}
### Real Options Framework

```{mermaid}
flowchart TD
    A[Real Options in Investment] --> B[Option to Defer]
    A --> C[Option to Expand]
    A --> D[Option to Abandon]
    A --> E[Option to Contract]
    A --> F[Option to Switch]
```

Real options create value through managerial flexibility to adapt to changing circumstances.

### Common Real Option Types

| Option Type | Description | Value Driver |
|-------------|-------------|-------------|
| Defer | Ability to postpone investment | Reduces uncertainty before committing |
| Expand | Opportunity to increase scale | Captures upside potential |
| Abandon | Ability to exit unprofitable projects | Limits downside risk |
| Contract | Option to reduce project scale | Mitigates losses in adverse conditions |
| Switch | Flexibility to change inputs/outputs | Adapts to changing market conditions |

### Valuation Approaches

Real options can be valued using:

1. **Black-Scholes Model** - For simple options with clear parameters
2. **Binomial Lattice** - For more complex, multi-stage options
3. **Monte Carlo Simulation** - For highly uncertain, complex situations

### Practical Example

A mining company considering a new site can view the investment as a series of options:

- Initial exploration (low cost, creates option to develop)
- Development phase (higher investment, creates option to extract)
- Extraction operations (option to expand/contract based on commodity prices)
- Site closure (abandonment option if prices fall below extraction costs)
:::

## Capital Rationing Decision Tree

When facing capital constraints, a structured approach helps maximise value creation.

:::{.panel-tabset}
### Decision Framework

```{mermaid}
flowchart TD
    A[Capital Rationing Situation] --> B{Soft or Hard?}
    B -->|Soft| C[Internal Policy Constraint]
    B -->|Hard| D[External Market Constraint]
    C --> E[Challenge Constraint]
    C --> F[Work Within Constraint]
    D --> G[Optimise Within Constraint]
    E --> H[NPV Ranking]
    F --> I[PI Ranking]
    G --> I
    I --> J[Mathematical Programming]
```

### Profitability Index Calculation

$$\text{PI} = \frac{\sum_{t=1}^{n} \frac{\text{Cash Flow}_t}{(1+r)^t}}{\text{Initial Investment}}$$

**Interpretation:**
- PI > 1.0: Project creates value
- PI = 1.0: Project breaks even
- PI < 1.0: Project destroys value

### Mathematical Programming Approach

For complex situations with multiple constraints, linear programming can be used:

**Objective function:**
$$\text{Maximise } \sum_{j=1}^{m} \text{NPV}_j \times X_j$$

**Subject to constraints:**
$$\sum_{j=1}^{m} \text{Investment}_j \times X_j \leq \text{Capital Budget}$$
$$X_j \in \{0,1\} \text{ or } 0 \leq X_j \leq 1 \text{ (depending on divisibility)}$$

Where:
- $X_j$ represents the proportion of project $j$ undertaken
- $m$ is the number of available projects
:::

## Incorporating Environmental, Social, and Governance (ESG) Factors

Modern investment appraisal increasingly considers ESG impacts alongside financial returns.

:::{.panel-tabset}
### ESG Framework

```{mermaid}
flowchart TD
    A[ESG-Integrated Investment Appraisal] --> B[Environmental Factors]
    A --> C[Social Factors]
    A --> D[Governance Factors]
    B --> E[Carbon Pricing]
    B --> F[Resource Efficiency]
    C --> G[Community Impact]
    C --> H[Human Capital]
    D --> I[Risk Management]
    D --> J[Stakeholder Alignment]
```

### Quantification Methods

| ESG Factor | Quantification Approach | Financial Integration |
|------------|-------------------------|----------------------|
| Carbon emissions | Shadow carbon price | Additional cost per tonne CO₂e |
| Water usage | True cost of water | Adjusted operating expenses |
| Community benefits | Social return on investment (SROI) | External benefit valuation |
| Human capital | Productivity differentials | Adjusted revenue/cost projections |
| Governance quality | Risk premium adjustment | Modified discount rate |

### Multi-Criteria Decision Analysis

When ESG factors are difficult to monetise, a weighted scoring approach can be used:

$$\text{Project Score} = \sum_{i=1}^{n} w_i \times \text{Factor Score}_i$$

Where:
- $w_i$ represents the weight assigned to factor $i$
- $\text{Factor Score}_i$ is the performance score for factor $i$
- $n$ is the number of decision factors (financial and non-financial)

### Case Example: Renewable Energy Investment

```{r}
renewable_factors <- data.frame(
  Factor = c("NPV (£m)", "IRR (%)", "Carbon Reduction (kt CO₂e)", "Jobs Created", "Community Index"),
  Project_A = c(12.5, 14.5, 80, 45, "High"),
  Project_B = c(15.2, 16.8, 60, 30, "Medium"),
  Project_C = c(10.8, 13.2, 95, 60, "Very High")
)

kable(renewable_factors, align = "lrrrr", caption = "Multi-criteria comparison of renewable energy projects")
```
:::

## Advanced Risk Analysis Techniques

Beyond sensitivity analysis, several sophisticated approaches help quantify investment risk.

:::{.panel-tabset}
### Risk Analysis Spectrum

```{mermaid}
flowchart LR
    A[Simple] --> B[Sensitivity Analysis]
    B --> C[Scenario Analysis]
    C --> D[Decision Trees]
    D --> E[Monte Carlo Simulation]
    E --> F[Complex]
```

### Monte Carlo Simulation Process

```{r, fig.width=10, fig.height=5}
# This would show a Monte Carlo simulation distribution in the actual document
# Creating placeholder data for illustration
set.seed(123)
simulation_results <- data.frame(
  NPV = rnorm(1000, mean = 350000, sd = 120000)
)

ggplot(simulation_results, aes(x = NPV)) +
  geom_histogram(bins = 30, fill = "blue", alpha = 0.7) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
  theme_minimal() +
  labs(title = "Monte Carlo Simulation of Project NPV",
       x = "Net Present Value (£)",
       y = "Frequency") +
  annotate("text", x = -200000, y = 50, label = "Probability of negative NPV", hjust = 0)
```

### Decision Tree Analysis

Decision trees incorporate sequential decisions and uncertain outcomes:

```{r}
decision_tree <- data.frame(
  Decision_Point = c("Initial Investment", "Expand Year 3?", "Expand Year 3?"),
  Decision = c("Proceed", "Yes", "No"),
  Outcome = c("Success (70%)", "High Growth", "Moderate Growth"),
  NPV = c("£4.5m", "£8.2m", "£5.1m"),
  Expected_Value = c("£2.0m", "£5.7m", "£3.6m")
)

kable(decision_tree, align = "lllrr", caption = "Decision tree analysis with expected values")
```

### Value at Risk (VaR)

For a confidence level α, VaR represents the maximum loss within the α-confidence interval:

```{r}
# This would show VaR calculations in the actual document
# Creating placeholder data for illustration
var_levels <- data.frame(
  Confidence = c("90%", "95%", "99%"),
  VaR_Amount = c("£220,000", "£285,000", "£390,000"),
  Interpretation = c("10% chance of losing more than £220,000",
                    "5% chance of losing more than £285,000",
                    "1% chance of losing more than £390,000")
)

kable(var_levels, align = "lrr", caption = "Value at Risk at different confidence levels")
```
:::

## Post-Implementation Review Framework

Systematic evaluation of completed projects improves future investment decisions.

:::{.panel-tabset}
### Review Process

```{mermaid}
flowchart TD
    A[Post-Implementation Review] --> B[Financial Performance]
    A --> C[Operational Performance]
    A --> D[Strategic Alignment]
    A --> E[Process Review]
    B --> F[Cash Flow Analysis]
    B --> G[NPV/IRR Assessment]
    C --> H[Timeline Achievement]
    C --> I[Quality Targets]
    D --> J[Strategic Objectives]
    E --> K[Decision Process Evaluation]
    F --> L[Variance Analysis]
    L --> M[Knowledge Capture]
    M --> N[Future Investment Improvement]
```

### Review Template

```{r}
review_template <- data.frame(
  Area = c("Financial", "Financial", "Operational", "Operational", "Strategic", "Process"),
  Metric = c("Cash Flow", "NPV", "Timeline", "Quality", "Strategic Fit", "Decision Quality"),
  Target = c("£3.5m cumulative", "£1.2m", "24 months", "99.5% spec compliance", "Support growth strategy", "Robust analysis"),
  Actual = c("£3.1m cumulative", "£0.9m", "28 months", "99.2% spec compliance", "Partially aligned", "Data gaps identified"),
  Variance = c("-11.4%", "-25.0%", "+16.7%", "-0.3%", "Partial", "Moderate")
)

kable(review_template, align = "llllr", caption = "Post-implementation review metrics")
```

### Lessons Learned Categories

Common areas for improvement identified in post-implementation reviews:

1. **Estimation accuracy** - Systemic biases in forecasting
2. **Risk identification** - Unforeseen risks or improper quantification
3. **Stakeholder management** - Communication and alignment challenges
4. **Resource allocation** - Availability and capability gaps
5. **External changes** - Market shifts or regulatory developments

### Implementation Framework

A structured implementation review provides insights for future investments:

```{r}
implementation_framework <- data.frame(
  Phase = c("Pre-approval", "Implementation", "Operation", "Closure"),
  Key_Questions = c(
    "Was the business case realistic and comprehensive?",
    "Were resources adequate and efficiently deployed?",
    "Did the investment achieve its intended outcomes?",
    "Was knowledge properly captured and disseminated?"
  ),
  Common_Findings = c(
    "Optimism bias in projections",
    "Scope creep and timeline extensions",
    "Lower-than-expected utilisation",
    "Insufficient documentation of lessons"
  )
)

kable(implementation_framework, align = "lll", caption = "Implementation phase review framework")
```
:::

## Key Takeaways {.unnumbered}

:::{.callout-note appearance="minimal"}
- Advanced capital investment techniques supplement rather than replace foundational methods like NPV and IRR
- Real options analysis captures the value of managerial flexibility in uncertain environments
- Capital rationing requires structured approaches to maximise value from limited resources
- ESG factors increasingly influence investment decisions and require systematic integration
- Sophisticated risk analysis provides deeper insights into potential outcomes and probabilities
- Post-implementation reviews are essential for organisational learning and improved decision-making
:::

## Reference List {.unnumbered}

**Academic References:**
- Damodaran, A. (2022). *Investment Valuation: Tools and Techniques for Determining the Value of Any Asset*, 4th Edition, Wiley Finance
- Dixit, A.K. & Pindyck, R.S. (2021). *Investment Under Uncertainty*, Princeton University Press
- Trigeorgis, L. & Reuer, J.J. (2023). *Real Options Theory in Strategic Management*, Strategic Management Journal, 44(4), pp. 842-878

**Professional Resources:**
- CIMA (2023). *Strategic Investment Decision Making: Best Practices*
- McKinsey & Company (2022). *Incorporating ESG Factors in Capital Allocation*
- PwC (2024). *Capital Project Excellence: From Appraisal to Post-Implementation*